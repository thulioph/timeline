/**
 * APP Modules Initilizer
 * Author: Dennis Calazans
 * 
 */
var APP = APP || {};

/**
 * APP's Module Namespace
 * @type {String}
 */
APP._nameSpace = "APP";

/**
 * Method delegation
 *
 * Using this method, 
 * you can create an anonymous function able to invoke a method 
 * inside an determined scope
 * 
 * @param  {Object} scope  Scope Object
 * @param  {function} method The method that will be invoked
 * @return {function}        Delegated method
 */
APP.delegate = function(scope, method) {
	var argumentsLength = arguments.length, methodArguments, i;

	if(argumentsLength > 2) {
		methodArguments = [];

		for(i = 2; i < argumentsLength; i++) {
			methodArguments.push(arguments[i]);
		}

		return function() {
			method.apply(scope, methodArguments)
		}
	} else {
		return function() { 
			method.apply(scope,arguments);
		};
	}
}

/**
 * Initialize all (arguments.length == 0) or several modules under APP
 * @param  object [Module,[...]] 
 * @return void
 */
APP.init = function(Module) {
	var modulesLength = arguments.length;
	if(Module !== undefined && Module !== APP) {
		APP.setUp();
	}

	if(modulesLength == 0 || modulesLength == 1) {
		this.readModule(Module || APP);
	} else if(modulesLength > 1) {
		APP.readModule.apply(this, arguments);
	}
};

//Main method
APP.setUp = function() {};

/**
 * Look for child Modules
 */
APP.readModule = function(Module) {
	var node, i=0;

	if(arguments.length > 1) {
		for(;i<arguments.length;i++) {
			APP.readModule(arguments[i]);
		} 
		return;
	}

	if(typeof Module != "object") return false;
	
	if(Module.hasOwnProperty('setUp') && typeof Module.setUp == "function") {
		Module.setUp();
	} else {
		return false;
	}
	
	for(node in Module) {
		

		if(Module.hasOwnProperty(node) === true) {
			if(Module[node] !== null && typeof Module[node] == "object") {
				
				//Auxiliar function to recover parent Module
				Module[node]['parent'] = function() {
					return Module;
				};

				//Mudule nameSpace definition
				Module[node]['_nameSpace'] = (Module['_nameSpace'] || "APP") + '.'+node;
				
				APP.readModule(Module[node]);
			}
		}
	}
	
	return false;
};

/**
 * Invoke a method by it's namespace
 * @param  String nameSpace Method's namespace
 * @param  Array params		Array of parameters
 * @return object 			Returned value of the method
 */
APP.applyByNamespace = function(nameSpace, params) {
	var node, nodes, scopes, target, i;

		if(params !== undefined && params instanceof Array === false) {
			params = [params];
		}

		scopes = [window];

		nodes = nameSpace.split('.');

		for(i=0;i<nodes.length;i++) {
			node = nodes[i];

			if(scopes[i].hasOwnProperty(node)) {

				scopes.push(scopes[i][node]);
			}
		}

		target = scopes.pop();

		if(typeof target == 'function') {
			return target.apply(scopes.pop(), params || []);
		}

		else { return target; }
}
var APP = APP || {};
APP.Timeline = {
  setUp: function() {
    this.addClass();
    this.trigger();
  },

  addClass: function() {
    $('#header-primary').addClass('js-closed');
    $('.text-complementary').addClass('js-hide');
  },

  stateOne: function() {
    $('#header-primary').removeClass('js-closed');
    $('#click-animation').css('bottom', '165px');
    $('#header-primary').addClass('js-open');
    APP.Timeline.showLegend();
    APP.Timeline.addPaddingContent();
    APP.Timeline.hideBody();
  },

  stateTwo: function() {
    $('#header-primary').removeClass('js-open');
    $('#click-animation').css('bottom', '170px');
    $('#header-primary').addClass('js-closed');
    APP.Timeline.hideLegend();
    APP.Timeline.removePaddingContent();
    APP.Timeline.showBody();
  },

  hideLegend: function() {
    $('.text-complementary').removeClass('js-show');
    $('.text-complementary').addClass('js-hide');
  },

  showLegend: function() {
    $('.text-complementary').removeClass('js-hide');
    $('.text-complementary').addClass('js-show');
  },

  hideBody: function() {
    var mask;
    mask = document.querySelector('#mask-modal');
    mask.classList.add('js-visible-modal');
  },

  showBody: function() {
    var mask;
    mask = document.querySelector('#mask-modal');
    mask.classList.remove('js-visible-modal');
  },

  addPaddingContent: function() {
    $('#content').addClass('js-padding');
  },

  removePaddingContent: function() {
    $('#content').removeClass('js-padding');
  },

  trigger: function() {
    $('#click-animation').on('click', function(event) {

      if ($('#header-primary').hasClass('js-closed')) {
        APP.Timeline.stateOne();
      } else {
        APP.Timeline.stateTwo();
      }

    });
  }
}

var APP = APP || {};
APP.Modal = {
  setUp: function() {
    this.clickOpen();
    this.clickClose();
  },

  openModal: function(href) {
    var href, element;

    href = href.replace(location.href, '');
    element = document.querySelector(href);
    element.style.visibility = 'visible';
    element.classList.add('open');

    APP.Modal.setStyleBody();
  },

  setStyleBody: function() {
    document.body.style.overflow = 'hidden';
    document.body.style.width = '100%';
    document.body.style.height = '100%';
    document.body.style.margin = '0';
    document.body.style.padding = '0';
    document.body.classList.add('js-bg-modal');

    var header = document.getElementById('header-primary');
    header.classList.add('js-modal');
  },

  closeModal: function(element) {
    element.style.visibility = 'hidden';
    element.classList.remove('open');

    document.body.style.overflow = 'visible';
    document.body.classList.remove('js-bg-modal');

    var header = document.getElementById('header-primary');
    header.classList.remove('js-modal');
  },

  clickOpen: function() {
    $('.reference').on('click', function(event){
      event.preventDefault();
      APP.Modal.openModal(this.href);
      APP.Modal.escModal();
    });
  },

  clickClose: function() {
    $('.close-modal').on('click', function(event) {
      event.preventDefault();
      var element = this.parentNode.parentNode; // div pai ou .modal

      APP.Modal.closeModal(element);
    });
  },

  escModal: function() {
    var element;
    element = document.querySelector('.open');

    $(document).keyup(function(event) {
      if(event.keyCode == 27) {
        APP.Modal.closeModal(element);
      }

    });
  }
}

var APP = APP || {};
APP.General = {
  setUp: function() {
    this.getClick();
  },

  getClick: function() {
    var href;

    $('.nav-list').on('click', 'a', function(event) {
      event.preventDefault();

      href = $(this).attr('href');

      APP.General.request(href);
    });
  },

  request: function(href) {
    $.ajax({
      url: href,

      beforeSend: function() {
        APP.Timeline.stateTwo();
        $('#content').html('Carregando conteÃºdo...');
      },

      success: function(href) {
        $('#content').html(href);
      },

      error: function() {
        console.log('Ocorreu um erro!');
      }
    });
  }
}

var APP = APP || {};
APP.Slide = {
  setUp: function() {
    this.activeSlide();
    // this.viewport();
  },

  viewport: function() {
    window.onresize = function(event) {
      var largura = window.innerWidth;

      if (largura <= 854) {
        console.log('MENOR!');
      } else {
        console.log('MAIOR!');
      }
    };
  },

  activeSlide: function() {
    $('#nav-list').slick({
        arrows: true,
        easing: 'linear',
        slidesToShow: 3,
        slidesToScroll: 3,
        slide: 'li',
        infinite: false
    });
  }
}
